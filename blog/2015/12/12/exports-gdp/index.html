      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>Importance of exports and economic growth, cross-country time series</title>
      	
         
         
            <meta name ="description" content ="Fitting a mixed-effects model with auto-correlated residuals to longitudinal country-level data, showing how changing importance of exports is positively related to economic growth.">
            <meta property="og:description" content ="Fitting a mixed-effects model with auto-correlated residuals to longitudinal country-level data, showing how changing importance of exports is positively related to economic growth.">
         
         <meta property="og:site_name" content="Peter's stats stuff" />
         <meta property="og:title" content="Importance of exports and economic growth, cross-country time series" />
         
            <meta property="og:image" content="http://ellisp.github.io/img/0023-p3.png" />
         
         <meta property="og:url" content="http://ellisp.github.io/blog/2015/12/12/exports-gdp/" />
         <meta property="og:author" content= "https://www.facebook.com/peter.ellis.353" />
         <meta property="og:type" content="article" />
           
          <link href="/css/bootstrap.min.css" rel ="stylesheet">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet">
            <link href="/css/custom.css" rel ="stylesheet">       
     <link rel="stylesheet" href="/css/Pygments/autumn.css">      
     <link rel="stylesheet" href="/css/Pygments/custom.css">      
            
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>

   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="Peter's stats stuff by Peter Ellis"
      href="/feed.xml">


      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
         <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
         <script src="/js/bootstrap.min.js"></script>
         
  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Peter's stats stuff</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="/">Home</a></li>
            <li><a href="/about">About</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">All blog posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">Ordered by date</a></li>
                  <li><a href="/blog/index_by_tag.html">Grouped by subject matter</a></li>
                  <li><a href = /blog/2016/04/03/nzelect1>Most recent post</a></li>
                 </ul>
            </li>
              <li><a href="/blog/showcase.html">Showcase</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			    <div class="jumbotron">
      <div class="container">
        <h1>Importance of exports and economic growth, cross-country time series</h1>
         <p class="meta">12 Dec 2015</p>
        
      </div>
    </div>




<div class = "post-summary">
<h2>TL;DR Summary:</h2>
   Fitting a mixed-effects model with auto-correlated residuals to longitudinal country-level data, showing how changing importance of exports is positively related to economic growth.
   <hr></hr>
</div>

<div class="post">
<div class="col-md-2">

</div>
  <div class="col-md-8">

  <h2 id="exports-and-economic-growth">Exports and economic growth</h2>
<p>I was looking to show a more substantive piece of analysis using the World Development Indicators data, and at the same time show how to get started on fitting a mixed effects model with grouped time series data.  The relationship between exports’ importance in an economy and economic growth forms a good start as it is of considerable theoretical and practical policy interest and has fairly reliable time series data for many countries.  At the most basic level, there is a well known positive relationship between these two variables:
<img src="/img/0023-p3.svg" alt="scatterplot" /></p>

<p>The relationship is made particularly strong by the small, rich countries in the top right corner.  Larger countries, with their own large domestic markets, can flourish economically while being less exports-dependent than smaller countries - the USA being the example par excellence.  If the regression is weighted by population, the relationship is much weaker than shown in the above diagram.</p>

<p>However, today, I’m looking at a different aspect of the relationship - changes over time.  Partly this is because I’m genuinely interested, but mostly because I needed an example demonstrating fitting a mixed effects model to longitudinal data with a time series component.</p>

<p>The data come from the World Bank’s <a href="http://databank.worldbank.org/data/reports.aspx?source=world-development-indicators">World Development Indicators</a> (WDI), which I explored recently in <a href="http://ellisp.github.io/blog/2015/12/05/wdi-inequality/">my last post</a>.  I’m comparing “Exports of goods and services (% of GDP)” with “GDP per capita (constant 2000 US$)”.  The WDI have at least some data on these variables for 186 countries, but different starting years for each (earliest being 1962).  The data look like this, in a connected scatterplot showing the relationship between the two variables for 12 randomly chosen countries:</p>

<p><img src="/img/0023-p1.svg" alt="csp1" /></p>

<p>… and this, in a more straightforward time series line plot:
<img src="/img/0023-p2.svg" alt="ts1" /></p>

<p>Close watchers will see that there are some country groupings in the dataset (eg “Pacific island small states”) that we don’t want, in addition to the individual countries we do.  So our first job is to get rid of these.  Here’s the R code that pulls in the data, draws the plots so far, and removes those country groupings.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><a name="True-1"></a><span class="kn">library</span><span class="p">(</span>WDI<span class="p">)</span>
<a name="True-2"></a><span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<a name="True-3"></a><span class="kn">library</span><span class="p">(</span>scales<span class="p">)</span>
<a name="True-4"></a><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<a name="True-5"></a><span class="kn">library</span><span class="p">(</span>tidyr<span class="p">)</span>
<a name="True-6"></a><span class="kn">library</span><span class="p">(</span>showtext<span class="p">)</span> <span class="c1"># for fonts</span>
<a name="True-7"></a><span class="kn">library</span><span class="p">(</span>nlme<span class="p">)</span>
<a name="True-8"></a>
<a name="True-9"></a><span class="c1"># import fonts</span>
<a name="True-10"></a>font.add.google<span class="p">(</span><span class="s">&quot;Poppins&quot;</span><span class="p">,</span> <span class="s">&quot;myfont&quot;</span><span class="p">)</span>
<a name="True-11"></a>showtext.auto<span class="p">()</span>
<a name="True-12"></a>theme_set<span class="p">(</span>theme_light<span class="p">(</span><span class="m">10</span><span class="p">,</span> base_family <span class="o">=</span> <span class="s">&quot;myfont&quot;</span><span class="p">))</span>
<a name="True-13"></a>
<a name="True-14"></a>
<a name="True-15"></a><span class="c1">#-------------------data imports, first explore, and clean-----------------</span>
<a name="True-16"></a><span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="kp">exists</span><span class="p">(</span><span class="s">&quot;exports&quot;</span><span class="p">)){</span>
<a name="True-17"></a>   <span class="c1"># Exports of goods and services (% of GDP)</span>
<a name="True-18"></a>   exports <span class="o">&lt;-</span> WDI<span class="p">(</span>indicator <span class="o">=</span> <span class="s">&quot;NE.EXP.GNFS.ZS&quot;</span><span class="p">,</span> end <span class="o">=</span> <span class="m">2015</span><span class="p">,</span> start <span class="o">=</span> <span class="m">1950</span><span class="p">)</span>
<a name="True-19"></a>   <span class="c1"># GDP per capita (constant 2000 US$)</span>
<a name="True-20"></a>   gdp <span class="o">&lt;-</span> WDI<span class="p">(</span>indicator <span class="o">=</span> <span class="s">&quot;NY.GDP.PCAP.KD&quot;</span><span class="p">,</span> end <span class="o">=</span> <span class="m">2015</span><span class="p">,</span> start <span class="o">=</span> <span class="m">1950</span><span class="p">)</span>
<a name="True-21"></a><span class="p">}</span>
<a name="True-22"></a>
<a name="True-23"></a>both <span class="o">&lt;-</span> <span class="kp">merge</span><span class="p">(</span>exports<span class="p">,</span> gdp<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-24"></a>   rename<span class="p">(</span>exports <span class="o">=</span> NE.EXP.GNFS.ZS<span class="p">,</span>
<a name="True-25"></a>          gdp <span class="o">=</span> NY.GDP.PCAP.KD<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-26"></a>   <span class="c1"># removing any year-country combos missing eith gdp or exports:</span>
<a name="True-27"></a>   filter<span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="kp">is.na</span><span class="p">(</span>exports<span class="p">)</span> <span class="o">|</span> <span class="kp">is.na</span><span class="p">(</span>gdp<span class="p">)))</span> <span class="o">%&gt;%</span>
<a name="True-28"></a>   arrange<span class="p">(</span>country<span class="p">,</span> year<span class="p">)</span>
<a name="True-29"></a>
<a name="True-30"></a><span class="c1"># let&#39;s look at 12 countries at a time</span>
<a name="True-31"></a>all_countries <span class="o">&lt;-</span> <span class="kp">unique</span><span class="p">(</span>both<span class="o">$</span>country<span class="p">)</span>
<a name="True-32"></a>sampled <span class="o">&lt;-</span> both    <span class="o">%&gt;%</span>
<a name="True-33"></a>   filter<span class="p">(</span>country <span class="o">%in%</span> <span class="kp">sample</span><span class="p">(</span>all_countries<span class="p">,</span> <span class="m">12</span><span class="p">))</span>
<a name="True-34"></a>   
<a name="True-35"></a><span class="c1"># connected scatter plot:</span>
<a name="True-36"></a>p1 <span class="o">&lt;-</span> sampled <span class="o">%&gt;%</span>
<a name="True-37"></a>   ggplot<span class="p">(</span>aes<span class="p">(</span>y <span class="o">=</span> gdp<span class="p">,</span> x <span class="o">=</span> exports<span class="p">,</span> colour <span class="o">=</span> year<span class="p">))</span> <span class="o">+</span>
<a name="True-38"></a>   facet_wrap<span class="p">(</span><span class="o">~</span>country<span class="p">,</span> scales <span class="o">=</span> <span class="s">&quot;free&quot;</span><span class="p">)</span> <span class="o">+</span>
<a name="True-39"></a>   geom_path<span class="p">()</span> <span class="o">+</span>
<a name="True-40"></a>   labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&quot;Exports as a percentage of GDP&quot;</span><span class="p">)</span> <span class="o">+</span>
<a name="True-41"></a>   scale_y_continuous<span class="p">(</span><span class="s">&quot;GDP per capita, constant 2000 US dollars&quot;</span><span class="p">,</span> label <span class="o">=</span> dollar<span class="p">)</span> <span class="o">+</span>
<a name="True-42"></a>   ggtitle<span class="p">(</span><span class="s">&quot;Exports and GDP over time, selected countries&quot;</span><span class="p">)</span>
<a name="True-43"></a>
<a name="True-44"></a>
<a name="True-45"></a><span class="c1"># univariate time series plots</span>
<a name="True-46"></a>p2 <span class="o">&lt;-</span> sampled <span class="o">%&gt;%</span>
<a name="True-47"></a>   gather<span class="p">(</span>variable<span class="p">,</span> value<span class="p">,</span> <span class="o">-</span><span class="p">(</span>iso2c<span class="o">:</span>year<span class="p">))</span> <span class="o">%&gt;%</span>
<a name="True-48"></a>   ggplot<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> year<span class="p">,</span> y <span class="o">=</span> value<span class="p">))</span> <span class="o">+</span>
<a name="True-49"></a>   geom_line<span class="p">()</span> <span class="o">+</span>
<a name="True-50"></a>   facet_wrap<span class="p">(</span><span class="o">~</span> country <span class="o">+</span> variable<span class="p">,</span> scales <span class="o">=</span> <span class="s">&quot;free_y&quot;</span><span class="p">)</span>
<a name="True-51"></a>
<a name="True-52"></a>
<a name="True-53"></a><span class="c1"># how to get rid of the country groups?</span>
<a name="True-54"></a><span class="kp">unique</span><span class="p">(</span>both<span class="p">[</span> <span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;iso2c&quot;</span><span class="p">,</span> <span class="s">&quot;country&quot;</span><span class="p">)])</span> <span class="o">%&gt;%</span> arrange<span class="p">(</span>iso2c<span class="p">)</span>
<a name="True-55"></a><span class="c1"># they have a number as first or second digit, or X or Z as first digit (but ZW ZA ZM legit)</span>
<a name="True-56"></a>
<a name="True-57"></a>both2 <span class="o">&lt;-</span> both <span class="o">%&gt;%</span>
<a name="True-58"></a>   filter<span class="p">(</span><span class="o">!</span><span class="kp">grepl</span><span class="p">(</span><span class="s">&quot;X.&quot;</span><span class="p">,</span> iso2c<span class="p">)</span> <span class="o">&amp;</span> <span class="o">!</span><span class="kp">grepl</span><span class="p">(</span><span class="s">&quot;[0-9]&quot;</span><span class="p">,</span> iso2c<span class="p">))</span> <span class="o">%&gt;%</span>
<a name="True-59"></a>   filter<span class="p">(</span><span class="o">!</span><span class="kp">grepl</span><span class="p">(</span><span class="s">&quot;Z.&quot;</span><span class="p">,</span> iso2c<span class="p">)</span> <span class="o">|</span> iso2c <span class="o">%in%</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;ZW&quot;</span><span class="p">,</span> <span class="s">&quot;ZA&quot;</span><span class="p">,</span> <span class="s">&quot;ZM&quot;</span><span class="p">))</span> <span class="o">%&gt;%</span>
<a name="True-60"></a>   filter<span class="p">(</span><span class="o">!</span>iso2c <span class="o">%in%</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;OE&quot;</span><span class="p">,</span> <span class="s">&quot;EU&quot;</span><span class="p">))</span>
<a name="True-61"></a>
<a name="True-62"></a><span class="c1">#------------------------simple cross section used for first plot-------------------</span>
<a name="True-63"></a>country_sum <span class="o">&lt;-</span> both2 <span class="o">%&gt;%</span>
<a name="True-64"></a>   group_by<span class="p">(</span>country<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-65"></a>   filter<span class="p">(</span>year <span class="o">==</span> <span class="kp">max</span><span class="p">(</span>year<span class="p">))</span>
<a name="True-66"></a>
<a name="True-67"></a>p3 <span class="o">&lt;-</span> country_sum <span class="o">%&gt;%</span>
<a name="True-68"></a>   ggplot<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> exports <span class="o">/</span> <span class="m">100</span><span class="p">,</span> y <span class="o">=</span> gdp<span class="p">,</span> label <span class="o">=</span> country<span class="p">))</span> <span class="o">+</span>
<a name="True-69"></a>   geom_text<span class="p">(</span>size <span class="o">=</span> <span class="m">3</span><span class="p">)</span> <span class="o">+</span>
<a name="True-70"></a>   geom_smooth<span class="p">(</span>method <span class="o">=</span> <span class="s">&quot;lm&quot;</span><span class="p">)</span> <span class="o">+</span>
<a name="True-71"></a>   scale_y_log10<span class="p">(</span>label <span class="o">=</span> dollar<span class="p">)</span> <span class="o">+</span>
<a name="True-72"></a>   scale_x_log10<span class="p">(</span>label <span class="o">=</span> percent<span class="p">)</span> <span class="o">+</span>
<a name="True-73"></a>   labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&quot;Exports as a percentage of GDP&quot;</span><span class="p">,</span>
<a name="True-74"></a>        y <span class="o">=</span> <span class="s">&quot;GDP per capita, constant 2000 US dollars&quot;</span><span class="p">,</span>
<a name="True-75"></a>        title <span class="o">=</span> <span class="s">&quot;Cross section of exports and GDP, latest years when data are present&quot;</span><span class="p">)</span></code></pre></div>

<p>The plan is to fit an appropriate time series model with GDP as a response variable and exports as a percentage of GDP as an explanatory variable, allowing country to be a group random effect, and the country-year individual randomness to be related year to year as a time series.  This means a <a href="https://en.wikipedia.org/wiki/Mixed_model">mixed effects model</a>. There’s a bit of transforming I need to do:</p>

<ul>
  <li>To avoid spurious correlation I’ll need to transform the data until each time series is at least approximately stationary.  I’ll do this by taking differences of the logarithm of the series, which has the same impact as looking at year on year growth rates.</li>
  <li>I’ll also need some kind of control for the nuisance factor that each country has a different starting year for its data.</li>
  <li>I want to control for the possibility that the absolute value of exports-orientation at the <em>start</em> of recorded data has a persistent impact, so I need to have that absolute level (or the logarithm of it, which has nicer properties) as a country-level variable.</li>
  <li>I’m interested in whether a change in exports has a persistent impact, so I’ll need a lagged value of my transformed exports variable.  Otherwise we might just be picking up the inherent impact on GDP of a change in exports or their prices, with domestic contribution to GDP kept constant.  If there’s a persistent effect on future years from a change exports-orientation in one year, it’s much more likely to reflect something significant economically (still not necessarily causal though).</li>
  <li>Even after taking first differences of the logarithms of my two main variables (GDP, and Exports as a percentage of GDP), I’m still a little worried that in particular countries there will be non-stationary time series that result in spurious associations.  For example, if the growth rates of both variables are steadily growing or declining.  To reduce this risk I’m going to include year in my model, so at least any linear trend of that sort is removed before looking at whether the two variables move together.</li>
</ul>

<p>Here’s the distribution of the first recorded value of the logarithm of exports as a percentage of gdp:
<img src="/img/0023-p4.svg" alt="first" /></p>

<p>Here’s the connected scatter plot of the differenced logarithms (effectively, growth rates):
<img src="/img/0023-p6.svg" alt="csp2" /></p>

<p>Here’s the traditional time series plots:
<img src="/img/0023-p5.svg" alt="ts2" /></p>

<p>And here’s the code that does the transformations and plots:</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><a name="True-1"></a><span class="c1"># first we want to know the value of exports at the beginning of each series</span>
<a name="True-2"></a>first_values <span class="o">&lt;-</span> both2 <span class="o">%&gt;%</span>
<a name="True-3"></a>   group_by<span class="p">(</span>country<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-4"></a>   filter<span class="p">(</span>year <span class="o">==</span> <span class="kp">min</span><span class="p">(</span>year<span class="p">))</span> <span class="o">%&gt;%</span>
<a name="True-5"></a>   ungroup<span class="p">()</span> <span class="o">%&gt;%</span>
<a name="True-6"></a>   mutate<span class="p">(</span>exports_starter <span class="o">=</span> <span class="kp">log</span><span class="p">(</span>exports<span class="p">),</span>
<a name="True-7"></a>          first_year <span class="o">=</span> year<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-8"></a>   select<span class="p">(</span>iso2c<span class="p">,</span> exports_starter<span class="p">,</span> first_year<span class="p">)</span>
<a name="True-9"></a>
<a name="True-10"></a>p4 <span class="o">&lt;-</span> ggplot<span class="p">(</span>both3<span class="p">,</span> aes<span class="p">(</span>x <span class="o">=</span> exports_starter<span class="p">))</span> <span class="o">+</span> geom_density<span class="p">()</span>
<a name="True-11"></a>
<a name="True-12"></a><span class="c1"># all those individual time series have problem of non-stationarity and of course autocorrelation</span>
<a name="True-13"></a><span class="c1"># so when we merge with the starting values of exports we also calculate first</span>
<a name="True-14"></a><span class="c1"># differences of logarithms</span>
<a name="True-15"></a>both3 <span class="o">&lt;-</span> both2 <span class="o">%&gt;%</span>
<a name="True-16"></a>   left_join<span class="p">(</span>first_values<span class="p">,</span> by <span class="o">=</span> <span class="s">&quot;iso2c&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-17"></a>   arrange<span class="p">(</span>country<span class="p">,</span> year<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-18"></a>   group_by<span class="p">(</span>country<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-19"></a>   mutate<span class="p">(</span>exports_g <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kp">diff</span><span class="p">(</span><span class="kp">log</span><span class="p">(</span>exports<span class="p">))),</span>
<a name="True-20"></a>          gdp_g <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kp">diff</span><span class="p">(</span><span class="kp">log</span><span class="p">(</span>gdp<span class="p">))),</span>
<a name="True-21"></a>          exports_lag <span class="o">=</span> lag<span class="p">(</span>exports_g<span class="p">))</span> <span class="o">%&gt;%</span>
<a name="True-22"></a>   ungroup<span class="p">()</span> <span class="o">%&gt;%</span>
<a name="True-23"></a>   filter<span class="p">(</span><span class="o">!</span><span class="kp">is.na</span><span class="p">(</span>gdp_g<span class="p">))</span> <span class="o">%&gt;%</span>
<a name="True-24"></a>   filter<span class="p">(</span><span class="o">!</span><span class="kp">is.na</span><span class="p">(</span>exports_lag<span class="p">))</span>
<a name="True-25"></a>
<a name="True-26"></a>all_countries2 <span class="o">&lt;-</span> <span class="kp">unique</span><span class="p">(</span>both3<span class="o">$</span>country<span class="p">)</span>
<a name="True-27"></a>
<a name="True-28"></a><span class="kp">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<a name="True-29"></a>sampled <span class="o">&lt;-</span> both3 <span class="o">%&gt;%</span>
<a name="True-30"></a>   filter<span class="p">(</span>country <span class="o">%in%</span> <span class="kp">sample</span><span class="p">(</span>all_countries2<span class="p">,</span> <span class="m">12</span><span class="p">))</span> 
<a name="True-31"></a>
<a name="True-32"></a>p5 <span class="o">&lt;-</span> sampled <span class="o">%&gt;%</span>
<a name="True-33"></a>   select<span class="p">(</span>country<span class="p">,</span> year<span class="p">,</span> exports_g<span class="p">,</span> gdp_g<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-34"></a>   gather<span class="p">(</span>variable<span class="p">,</span> value<span class="p">,</span> <span class="o">-</span><span class="p">(</span>country<span class="o">:</span>year<span class="p">))</span> <span class="o">%&gt;%</span>
<a name="True-35"></a>   ggplot<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> year<span class="p">,</span> y <span class="o">=</span> value<span class="p">))</span> <span class="o">+</span>
<a name="True-36"></a>   geom_line<span class="p">()</span> <span class="o">+</span>
<a name="True-37"></a>   facet_wrap<span class="p">(</span><span class="o">~</span> country <span class="o">+</span> variable<span class="p">,</span> scales <span class="o">=</span> <span class="s">&quot;free_y&quot;</span><span class="p">)</span>
<a name="True-38"></a>
<a name="True-39"></a>p6 <span class="o">&lt;-</span> sampled <span class="o">%&gt;%</span>
<a name="True-40"></a>   select<span class="p">(</span>country<span class="p">,</span> year<span class="p">,</span> exports_g<span class="p">,</span> gdp_g<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-41"></a>   ggplot<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> exports_g<span class="p">,</span> y <span class="o">=</span> gdp_g<span class="p">,</span> colour <span class="o">=</span> year<span class="p">))</span> <span class="o">+</span>
<a name="True-42"></a>   geom_smooth<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> method <span class="o">=</span> <span class="s">&quot;lm&quot;</span><span class="p">)</span> <span class="o">+</span>
<a name="True-43"></a>   geom_path<span class="p">()</span> <span class="o">+</span>
<a name="True-44"></a>   geom_point<span class="p">()</span> <span class="o">+</span>
<a name="True-45"></a>   facet_wrap<span class="p">(</span><span class="o">~</span> country<span class="p">,</span> scales <span class="o">=</span> <span class="s">&quot;free&quot;</span><span class="p">)</span> <span class="o">+</span>
<a name="True-46"></a>   labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&quot;change in logarithm of exports share of GDP&quot;</span><span class="p">,</span>
<a name="True-47"></a>        y <span class="o">=</span> <span class="s">&quot;change in logarithm of GDP per capita, constant 2000 USD&quot;</span><span class="p">,</span>
<a name="True-48"></a>        title <span class="o">=</span> <span class="s">&quot;Changing importance of exports and GDP growth, selected countries&quot;</span><span class="p">)</span></code></pre></div>

<p>So we’re ready for some modelling.  After all the data transformations, this part is relatively easy.  I use a mixed effects model that lets the key effects vary in each country, around an average level of the effect.</p>

<p>I tried a few simpler models than below and checked the auto-correlation functions to be sure the time series part was needed (it is; ACF() returns an autocorrelation at lag 1 of around 0.23, and the decay of autocorrelation in subsequent lags characteristic of a fairly simple AR process).  So here we go:</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><a name="True-1"></a>model4 <span class="o">&lt;-</span> lme<span class="p">(</span>fixed <span class="o">=</span> gdp_g <span class="o">~</span> <span class="kp">ordered</span><span class="p">(</span>first_year<span class="p">)</span> <span class="o">+</span> exports_g <span class="o">+</span> exports_lag <span class="o">+</span> exports_starter <span class="o">+</span> year<span class="p">,</span>
<a name="True-2"></a>              random <span class="o">=</span> <span class="o">~</span> exports_g <span class="o">+</span> exports_lag <span class="o">+</span> year <span class="o">|</span> country<span class="p">,</span> 
<a name="True-3"></a>              correlation <span class="o">=</span> corAR1<span class="p">(</span>form <span class="o">=</span> <span class="o">~</span> year <span class="o">|</span> country<span class="p">),</span>
<a name="True-4"></a>              data <span class="o">=</span> both3<span class="p">)</span></code></pre></div>

<p>Just to visualise what this model is doing, imagine the connected scatter plot of the differenced logarithms of each variable, as shown earlier.  We’re drawing a diagonal line of best fit on each facet, with the  slope and  intercept of each line allowed to different for each country.  The average slope is the average impact of changes in exports as a percent of GDP on GDP growth.  Now add to this the complication of the other variables - the first year data starts (basically just a nuisance variable we want to control for); each countrys’ absolute level of exports as a percentage of GDP when its data started; the lagged value of exports (which is actually the number of most interest); and year, for which we’re trying to control for any linear trend.</p>

<p>The “correlation = corAR1(…)” part is important, as it means that when we come to conduct inference (t statistics, p values and confidence intervals) the model takes into account that each observation in a particular country is related to the previous year’s - they aren’t as valuable as independent and identically distributed data from a simple random sample.  Failing to include this factor would mean that inference was biased in the direction of concluding results are significant that are in fact due to chance.</p>

<p>And here are the results.  Bear in mind that:</p>

<ul>
  <li>the response variable is change in the logarithm of GDP;</li>
  <li>exports_g is change in the logarithm of exports as a percentage of GDP;</li>
  <li>exports_lag is the lagged value of exports_g;</li>
  <li>exports_starter is the logarithm of the starting value of exports as a percentage of GDP;</li>
  <li>year is year, and we are testing for a linear trend in growth of GDP</li>
</ul>

<div class="highlight"><pre><code class="language-r" data-lang="r"><a name="True-1"></a><span class="o">&gt;</span> <span class="kp">round</span><span class="p">(</span><span class="kp">tail</span><span class="p">(</span><span class="kp">summary</span><span class="p">(</span>model4<span class="p">)</span><span class="o">$</span>tTable<span class="p">,</span> <span class="m">4</span><span class="p">),</span> <span class="m">3</span><span class="p">)</span>
<a name="True-2"></a>                 Value Std.Error   DF <span class="kp">t</span><span class="o">-</span>value p<span class="o">-</span>value
<a name="True-3"></a>exports_g        <span class="m">0.031</span>     <span class="m">0.010</span> <span class="m">7006</span>   <span class="m">3.191</span>   <span class="m">0.001</span>
<a name="True-4"></a>exports_lag      <span class="m">0.021</span>     <span class="m">0.006</span> <span class="m">7006</span>   <span class="m">3.579</span>   <span class="m">0.000</span>
<a name="True-5"></a>exports_starter <span class="m">-0.002</span>     <span class="m">0.002</span>  <span class="m">150</span>  <span class="m">-1.233</span>   <span class="m">0.220</span>
<a name="True-6"></a>year             <span class="m">0.000</span>     <span class="m">0.000</span> <span class="m">7006</span>  <span class="m">-1.328</span>   <span class="m">0.184</span></code></pre></div>

<p>Not wanting to give too precise an interpretation of this without a bit more theory and thinking, it suggests for countries on average:</p>

<ul>
  <li>evidence of impact (on GDP growth) of a change in exports as a percentage of GDP, and the impact is in the same direction;</li>
  <li>the impact persists beyond the immediate year into subsequent years;</li>
  <li>no evidence of a systematic change in growth rates of GDP over time simply related to time and nothing else in the model;</li>
  <li>no evidence that the starting absolute value of exports as a percentage of GDP impacts on subsequent GDP growth rates</li>
</ul>

<p>As exports_g, exports_lag and year were all allowed to be random effects ie take different values by country, their differing values for each country are of interest.  The figures above reflect an overall effect of these variables; the actual value in any country is a (approximately) normally distributed random variable.  Here’s how their’ densities look:</p>

<p><img src="/img/0023-p7.svg" alt="ref" /></p>

<p>Each observation (the little rug marks on the horizontal axis) is the size of the effect for a particular country.  So we can see that while overall value of exports_lag - the persistent impact of a change in exports as a percentage of GDP on GDP growth - was 0.021 as per the table above, any particular country has a value that is lower or hight than that, with a reasonable number of countries seeing a negative impact.</p>

<p>The value for the exports_g parameter plus the exports_lag parameter gives a crude sense of the overall impact, for a particular country, of changing importance of exports on GDP growth.  As can be seen from the top right panel of the above set of plots, this combined value is generally but not always positive.</p>

<p>All up, while we might conclude that for countries “on average” there is a positive relationship between growth in the importance of exports and GDP growth, for any particular country the relationship will vary and may in fact be negative.  Further investigation would need to place this in a more theoretical context, and control for other variables that might be confounding the results; but the above is probably enough for an exploratory blog post.</p>

<p>Here’s how to extract those country-level effects from our mixed effects model object:</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><a name="True-1"></a>cf <span class="o">&lt;-</span> coef<span class="p">(</span>model4<span class="p">)</span>
<a name="True-2"></a>
<a name="True-3"></a><span class="c1"># let&#39;s look at just the last four coefficients ie exclude the nuisance of first_year</span>
<a name="True-4"></a>cf_df <span class="o">&lt;-</span> cf<span class="p">[,</span> <span class="p">(</span><span class="kp">ncol</span><span class="p">(</span>cf<span class="p">)</span> <span class="o">-</span> <span class="m">3</span><span class="p">)</span><span class="o">:</span><span class="kp">ncol</span><span class="p">(</span>cf<span class="p">)]</span> <span class="o">%&gt;%</span>
<a name="True-5"></a>   <span class="kp">as.data.frame</span><span class="p">()</span> <span class="o">%&gt;%</span>
<a name="True-6"></a>   mutate<span class="p">(</span>country <span class="o">=</span> <span class="kp">rownames</span><span class="p">(</span>cf<span class="p">),</span>
<a name="True-7"></a>          combined <span class="o">=</span> exports_lag <span class="o">+</span> exports_g<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-8"></a>   arrange<span class="p">(</span>combined<span class="p">)</span>
<a name="True-9"></a>
<a name="True-10"></a>
<a name="True-11"></a>p7 <span class="o">&lt;-</span> cf_df <span class="o">%&gt;%</span>
<a name="True-12"></a>   gather<span class="p">(</span>variable<span class="p">,</span> value<span class="p">,</span> <span class="o">-</span>country<span class="p">,</span> <span class="o">-</span>exports_starter<span class="p">)</span> <span class="o">%&gt;%</span>
<a name="True-13"></a>   mutate<span class="p">(</span>variable <span class="o">=</span> <span class="kp">gsub</span><span class="p">(</span><span class="s">&quot;combined&quot;</span><span class="p">,</span> <span class="s">&quot;exports_g + exports_lag&quot;</span><span class="p">,</span> variable<span class="p">,</span> fixed <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span> <span class="o">%&gt;%</span>
<a name="True-14"></a>   ggplot<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> value<span class="p">))</span> <span class="o">+</span>
<a name="True-15"></a>   facet_wrap<span class="p">(</span><span class="o">~</span>variable<span class="p">,</span> scales <span class="o">=</span> <span class="s">&quot;free&quot;</span><span class="p">)</span> <span class="o">+</span>
<a name="True-16"></a>   geom_density<span class="p">()</span> <span class="o">+</span>
<a name="True-17"></a>   geom_rug<span class="p">()</span></code></pre></div>


</div>

<div class = "container">
   <div class="col-md-4">
    
        <a rel="prev" href="/blog/2015/12/05/wdi-inequality">
        <p>&larr; Older</p>
        <p>Inequality measures in the World Development Indicators</p>
        
        </a>
    
    </div>
    <div class="col-md-4">
    </div>
    <div class="col-md-4" style="text-align: right;">
     
        <a rel="next" href="/blog/2015/12/21/m3-and-x13">
        <p>Newer &rarr;</p>
        <p>X13-SEATS-ARIMA as an automated forecasting tool</p>
        
        </a>
    
      </div>
      </div>
      
      
      
</div>


   
    <div id="disqus_thread"></div>

    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'statsinthewild';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'statsinthewild';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    
    
   
			
			</div><!-- /.container -->

         

   <div class = "container footer">
			<footer>
	    		
            <p>Follow <a href = "/feed.xml">this blog with RSS</a>.  Or follow <a href = "/feed.r.xml">posts in this blog featuring R with RSS</a>.</p>
	
            <p>This blog is built with <a href = "http://jekyllrb.com/">Jekyll</a>, <a href = "http://getbootstrap.com/">Bootstrap</a>, <a href = "https://www.ruby-lang.org/en/">Ruby</a> and <a href = "https://cran.r-project.org/">R</a>.  Read my <a href="/about/acknowledgements.html">acknowledgements</a> for a little more on how.  I'm pleased to be aggregated at <a href="http://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>

            <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Peter's stats stuff</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="/" property="cc:attributionName" rel="cc:attributionURL">Peter Ellis</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.


			</footer>
    </div>



  
</body>
</html>
   




         
