---
layout: post
title: Playing with the M3 forecast data
date: 2015-12-20
tag: 
   - Forecasting
   - Timeseries
   - R
description: Using the data from the M3 forecast competition in 2000 to benchmark the forecasting capability of X13-SEATS-ARIMA with its default values gives disappointing results, and confirms Rob Hyndman's finding that the best simple approach to forecasting in R is a hybrid of methods from the {forecast} package.
image: /img/0023-p6.svg
socialimage: http://ellisp.github.io/img/0023-p3.png
category: R
---
## The M3 forecasting competition
The M3 forecasting competition organized by Spyros Makridakis and Michele Hibon tested a variety of methods against 3,003 time series, with forecasts compared to held out test sets.  The data are conveniently available for R users in the [Mcomp package](https://cran.r-project.org/web/packages/Mcomp/index.html) and [Rob Hyndman has published example code](http://robjhyndman.com/hyndsight/show-me-the-evidence/) benchmarking the ets() and auto.arima() functions from his forecast package against the results in 2000.

Hyndman has [a good outline of the various measures of forecast accuracy](http://www.robjhyndman.com/papers/forecast-accuracy.pdf).  I buy the argument that Mean Absolute Scaled Error (MASE) is a better general indicator of forecast accuracy than any of the variants on percentage error, which fall apart when the series has negative values or values that go near to zero.  

## Objectives
I wanted to:

1. confirm Hyndman's results in his "show me the evidence" blog, showing that a combination of auto.arima() and ets() gives very good out-of-the-box forecasting results
2. see how X13-SEATS-ARIMA, when run with its default values, compares to the methods benchmarked by Hyndman
3. explore how the surprisingly successful theta method works, and check whether Hyndman's implementation of the theta method in his forecast package (slightly different to that used in the competition in 2000) gives better results on these data than does the combination of ets() and auto.arima() that he recommends
4. See if alternative hybrids of methods may be better than the hybrid of ets() and auto.arima()

To do this I modified Hyndman's benchmarking code to add five additional forecasting methods:

* theta
* X13-SEATS-ARIMA
* hybrid of theta, ets and auto.arima
* hybrid of theta and ets
* hybrid of theta and auto.arima

## X13-SEATS-ARIMA

### Why does X13 sometimes fail?

Three types of error

#### struggles to handle high degree of integration
> seas(M3[[434]]$x, regression.aictest = NULL)
Error: X-13 run failed

Errors:
- Nonseasonal AR polynomial with initial parameters is nonstationary with root(s) on or inside the unit circle. RESPECIFY the model with different initial parameters.
  
#### runs but produces no data
> seas(M3[[807]]$x)
Error: X-13 has run but produced no data


#### cannot process spec file for an unknown reason
> seas(M3[[1485]]$x)
Error: X-13 has returned a non-zero exist status, which means that the current spec file cannot be processed for an unknown reason.



#### can't handle phony date/times
Financial series are not recorded with their actual dates
> seas(M3[[3000]]$x)
Error in seas(M3[[3000]]$x) : 
  start year of 'x' must be > 999.

### When it succeeds, why is X13 worse than auto.arima?


{% highlight R lineanchors %}

{% endhighlight %}