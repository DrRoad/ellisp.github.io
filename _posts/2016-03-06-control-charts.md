---
layout: post
title: Skill v luck in determining backgammon winners
date: 2016-02-29
tag: 
   - Backgammon
   - R
description: I explore the relationship between decision quality and winning in backgammon, using data from XG-Gammon analysis of matches on FIBS and grid.gammon
image: /img/0032-luck-v-net-skill.svg
socialimage: http://ellisp.github.io/img/0032-luck-v-net-skill.png
category: R
---

## Getting backgammon data out of XG-Gammon
Backgammon is a game that combines chance and skill.  Since the rise of robot players that used machine learning neural networks to identify winning strategies, it has become possible to quantify exactly how much skill and how much chance.  Each decision by a player can be compared with an optimal play that the computer would have made, and the computer can estimate exactly how much equity in the final result you just gave up by playing differently to how it would have done.  If you give up 1, you just moved from being certain to win to certain to lose; in practice losing 0.080 of your equity in one turn is usually defined as a "blunder", and 0.020 as an "error".  Whereas gaining 0.300 of equity by a luck dice roll is a common threshold for a "joker".  Here's a [post from ancient history (ie 2005) on the origin of the term "blunder" in backgammon](http://www.bkgm.com/rgb/rgb.cgi?view+1273) - apparently it only goes back to 1998, who knew?

Of course, while you're playing a human under match conditions, you don't know that you just gave up 0.096 of your equity, although sometimes you have a pretty good idea from a nagging feeling of "I really shouldn't have done that...".  We quantify our errors in post-match analysis (of course, you can play a computer in tutor mode too, and that's the best way to train, but not the subject of today's post). 

As well as being the best backgammon player on the planet, XG-Gammon software is used by many backgammon players to analysis their own matches, to identify areas for improvement and (let's face it) to find out if the opponent really was as lucky as we thought they were.  Online sites like FIBS (the First Internet Backgammon Server - open, free for all, lots of swearing, a bit clunky but a a great environment) and grid.gammon (invitation only, more players and more of them are very serious and skilled) let you save games you've just played in formats that can be opened and analysed for luck and mistakes by the various backgammon-playing software.  If the user saves the analytical results to player profiles, you build up a database of games and matches.  Against humans, I play mostly matches (eg first to X points, where common values of X are 3, 5, 7 and 11) and in this post I'm analysing match-level data; that is, ultimately I am using a spreadsheet generated by XG-Gammon where there is one row for each match I've played, with 54 columns of interesting data about that match.

To get this data out of XG-Gammon:

* choose "players"
* "see profile results"
* From the "Results" menu, choose "Copy to clipboard"
* "sessions list" (not sessions list (Match Play) - for me, this just freezes my system)
* open Excel or equivalent and paste it in.
* save it as a CSV, close Excel and load the data into a real analytical environment like R.  Actually, this is me being snobbish - any backgammon players reading this who don't want to use specialist analytical software like R, you can do a lot with Excel and I encourage you to have a go.

I keep my on-line profile, where I play matches against real opponents, separate from any practice I do against XG-Gammon in tutor mode, so when I do the above steps I get genuine record of how well I've played.

## Elo rating
One thing people sometimes wonder about is the relationship between equity loss per decision and [Elo rating](http://www.bkgm.com/faq/Ratings.html).  There can be no fundamental permanent relationship.  Elo rating is basically a relativistic statement of how good you are (or rather, how well you've gone) compared to the people you play against; equity loss per decision is an absolute comparison of your decision making to a robot powered by a neural network.

Imagine a backgammon competition, with the same rules as FIBS in year zero, populated only by bots.  In FIBS current conditions, these bots have ratings around 2100 compared to the starting point that all new players get of 1500 (chess players may think this is surprisingly low - that's because the element of chance in backgammon means that the worst player in the world still has a chance against the best, which puts a virtual ceiling on how high the Elo ratings can get).  But in our new world after we reboot FIBS only for expert bot players, the bots will only be able to play eachother, and their Elo ratings will all hover around 1500.  Not exactly 1500, there will be a range, but it will be an illusion created by random chance.  See [my earlier post on Elo ratings for more discussion of this](http://ellisp.github.io/blog/2015/08/07/fibs-elo-ratings-basics/).  So the 2100 ratings the bots have in our current world are arbitrarily linked to the errors of the people they happen to be playing.

However, there's enough stability in the Elo rating system that we know roughly how good a player with a FIBS rating of 1800 is, and XG-Gammon at some point in its life worked out a rule of thumb (ie statistical model) that mapped from the equity given up per decision to the Elo rating you'd expect an online player who consistently played at that level to end up with.  From the data we've just extracted from XG-Gammon, it's possible to reverse engineer that relationship.  The data we got from our player profile included a column for "Eq per decision" and one for "Elo Level".  The first of these is it's estimate of how much equity on average you gave up when you had a choice (ie excluding times you had no legal moves); the second is the estimate of what your Elo level should be given your decision-making.  Here's the relationship:


![elo-ratings](/img/0032-Elo.svg)

So we can see that if you consistently play with a PR of 10 which qualifies yuou to be 'advanced' in most people's books, you should expect eventually an Elo rating of a bit over 1700.  This seems a lowish Elo rating to me compared to what I intuit are standards on FIBS (my average PR hovers around 11 and Elo rating on FIBS currently at 1800 whereas XG thinks I should be only 1663), but it will be different in any different pool of players and without more data there's no point in arguing.  Probably the rating is relative to the pool on grid.gammon

All the code that created graphics is at the bottom of the post.

In that graphic above, I've annotated the horizontal axis with the XG Player Rating (PR), which is probably more familiar to most backgammon players.  I couldn't find it defined in the XG manual, but according to this [authoritative sounding forum post](http://www.bgonline.org/forums/webbbs_config.pl?noframes;read=53424) the XG Player Rating is just the equity error per decision multiplied by 500.  So if you give up 0.01 (or 1%) of your equity each decision on average, you come up with a PR rating of 5, which is excellent [and qualifies you as a 'Master'](http://bgmastersab.com/).

By definition (at least when it is XG that does the rating), XG's PR is 0.

## Skill versus luck
Another column of interest is the "Cost luck" column.  This contains XG's estimate of how much the rolls of the dice cost you in total.  It's all very well to keep your error rate down to only give up 1% of your equity each turn, but what about those jokers and anti-jokers that push it 0.3 or more in either direction at a single roll of the dice?  An obvious thing to do is to compare the "Cost luck" columnm with the equity per turn / PR data, and colour code each point on the resulting scatter plot by whether it was a win or a loss.  The result is illuminating:

![skill-v-luck](/img/0032-luck-v-skill.svg)

Yup, the luck alone is all you need to divide matches into two very obvious clusters - those where you were lucky, and those where you weren't.  It's a cruel game, and a fascinating one - this luck means that you have to play a lot of games before your skill level starts determining your average success rate, and at the end of the game you don't know (without a bot to help you) whether it was your fault or not...







{% highlight R lineanchors %}



{% endhighlight %}

